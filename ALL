' 文字列をクリップボードにコピー
' TStr  : コピーする文字列
'
Sub ClipBdPutText(TStr As String)
    With CreateObject("Forms.TextBox.1")
    .MultiLine = True
    .text = TStr
    .SelStart = 0
    .SelLength = .TextLength
    .Copy
    End With
End Sub

' クリップボードから文字列を取得
' TData  : 取得した文字列 (戻り値)
' 戻り値 : True  = 取得成功
'          False = 取得失敗
' 参照設定 : Microsoft Forms 2.0 Object Library
' 補足 : Excel以外(Access等でも使用可能)
'
Public Function ClipBdGetText(ByRef TData As String) As Boolean
    On Error GoTo EndProc
    Dim CB As DataObject
    
    TData = ""  ' TData初期化
    Set CB = New DataObject
    With CB
    .GetFromClipboard
    If .GetFormat(1) Then    ' 1 = vbCFText
        TData = .GetText
        ClipBdGetText = True
    End If
    End With
EndProc:
    Set CB = Nothing
End Function


